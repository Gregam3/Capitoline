<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<body>
<div class="panel panel-default" th:fragment="holding-management" ng-controller="holdingManagementCtrl">
    <div class="panel-heading">
        <div class="row">
            <div class="col-xs-10">
                <h3>Holdings <span class="fa fa-money"></span>
                    <span class="fa fa-money-bill"></span>
                </h3>
                You can watch holdings by adding them with a quantity of 0
            </div>
            <div class="col-xs-2">
                <label>
                    <button ng-click="addHolding()">
                        Add Holding <span class="fa fa-plus"></span>
                    </button>
                </label>
            </div>
        </div>
    </div>
    <div class="panel-body">

        <table st-table="rowCollection" class="table table-striped table-large-font"
               ng-hide="isObjectEmpty(holdings.stocks)">
            <thead>
            <tr>
                <th class="fixed-column">Stock Name</th>
                <th class="fixed-column">Quantity</th>
                <th class="fixed-column">Price</th>
                <th class="fixed-column">Total Holdings</th>
                <th class="fixed-column">Total Change</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="stock in holdings.stocks">
                <td>{{stock.name}} ({{stock.acronym}})</td>
                <td>{{(stock.totalQuantity !== 0 ) ? stock.totalQuantity.toFixed(2) : "Watch only"}}</td>
                <td>{{userCurrency.symbol}}{{(stock.price * userCurrency.modifier).toFixed(2) | number}}</td>
                <td>{{userCurrency.symbol}}{{(stock.totalValue * userCurrency.modifier).toFixed(2) | number}}</td>
                <!-- Condition won't accept '<', used '!>' as an alternative -->
                <td ng-show="stock.price > 0"
                    ng-class="{'holding-up': stock.totalValue > stock.acquisitionCost,
                'holding-down': !(stock.totalValue > stock.acquisitionCost)}">
                    {{(stock.totalValue > stock.acquisitionCost) ? "▲" : "▼" }}
                    {{((stock.totalValue / stock.acquisitionCost) * 100 - 100).toFixed(2)}}%
                </td>
                <td>
                    <input type="number" placeholder="Number to remove" ng-model="amountToRemove"/>
                    <button ng-click="removeHolding(stock.acronym, stock.holdingType, amountToRemove)">Remove
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
        <table st-table="rowCollection" class="table table-striped table-large-font"
               ng-hide="isObjectEmpty(holdings.cryptos)">
            <thead>
            <tr>
                <th class="fixed-column">Crypto Name</th>
                <th class="fixed-column">Quantity</th>
                <th class="fixed-column">Price</th>
                <th class="fixed-column">Total Holdings</th>
                <th class="fixed-column">Total Change</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="crypto in holdings.cryptos">
                <td>{{crypto.name}} ({{crypto.acronym}})</td>
                <td>{{(crypto.totalQuantity !== 0 ) ? crypto.totalQuantity : "Watch only"}}</td>
                <td>{{userCurrency.symbol}}{{(crypto.price * userCurrency.modifier).toFixed(2) | number}}</td>
                <td>{{userCurrency.symbol}}{{((crypto.totalQuantity * crypto.price) *
                    userCurrency.modifier).toFixed(2)
                    | number}}
                </td>
                <td ng-class="{'holding-up': crypto.totalValue > crypto.acquisitionCost,
                'holding-down': !(crypto.totalValue > crypto.acquisitionCost)}">
                    {{(crypto.totalValue > crypto.acquisitionCost) ? "▲" : "▼" }}
                    {{((crypto.totalValue / crypto.acquisitionCost) * 100 - 100).toFixed(2)}}%
                </td>
                <td>
                    <input type="number" placeholder="Number to remove" ng-model="amountToRemove"/>
                    <button ng-click="removeHolding(crypto.acronym, crypto.holdingType, amountToRemove)">Remove
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
        <table st-table="rowCollection" class="table table-striped table-large-font"
               ng-hide="isObjectEmpty(holdings.fiats)">
            <thead>
            <tr>
                <th class="fixed-column">Currency Name</th>
                <th class="fixed-column">Quantity</th>
                <th class="fixed-column">Price</th>
                <th class="fixed-column">Total Holdings</th>
                <th class="fixed-column">Total Change</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="fiat in holdings.fiats">
                <td>{{fiat.acronym}} - {{fiat.name}}</td>
                <td>{{(fiat.totalQuantity !== 0) ? fiat.totalQuantity.toFixed(2) : "Watch only"}}</td>
                <td>{{userCurrency.symbol}}{{(fiat.price * userCurrency.modifier).toFixed(2) | number}}</td>
                <td>{{userCurrency.symbol}}{{((fiat.totalQuantity * fiat.price) * userCurrency.modifier).toFixed(2)
                    |
                    number}}
                </td>
                <td ng-class="{'holding-up': fiat.totalValue > fiat.acquisitionCost,
                'holding-down': !(fiat.totalValue > fiat.acquisitionCost)}">
                    {{(fiat.totalValue > fiat.acquisitionCost) ? "▲" : "▼" }}
                    {{((fiat.totalValue / fiat.acquisitionCost) * 100 - 100).toFixed(2)}}%
                </td>
                <td>
                    <input type="number" placeholder="Number to remove" ng-model="amountToRemove"/>
                    <button ng-click="removeHolding(fiat.acronym, fiat.holdingType, amountToRemove)">Remove</button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>